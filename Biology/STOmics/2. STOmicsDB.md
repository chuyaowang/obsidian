# 时空组学数据库

> [第二课](https://wx.vzan.com/live/page/874424384?v=1701342116000&jumpitd=1)

## [STOmics数据库](https://db.cngb.org/stomics)

- 数据最全
- 数据归档标准，格式统一
- 持续更新

![[2. 时空数据与数据库.pdf#page=5]]

### 数据分析

![[2. 时空数据与数据库.pdf#page=6]]

### 数据获取

- 搜索框检索
- 选项卡内筛选
	- 时间排序
	- 物种
	- 组织
	- 技术
	- 数据完整度
	- 排序方式

### 探索数据

- 数据集详情页
	- 处理方式
	- 简介
	- 基本信息
- 可视化
	- 查看聚类
		- 可切换不同时空组切片
		- 降维：UMAP/tSNE
		- 选择查看不同基因表达
		- 选择查看不同细胞分类分布
		- 分类的Marker gene分布
	- 查看热图
		- 选择一个以上基因
		- 对应分类的Marker gene
	- 点图
	- 小提琴图：不同基因在不同分类的表达情况
- 数据挖掘
	- n_genes_per_count：每个细胞中count≧1的基因数目；如果数目过少，可能细胞已经死亡
	- total_count：每个细胞中总count数
	- Marker gene: 自动找到Top 10 marker genes; 热图和表格
	- 富集分析：
		- 差异基因火山图
		- GO富集
		- KEGG富集
	- 细胞通讯分析：
		- 细胞通讯网络互作用
		- 细胞通讯
	- 空间特异性：
		- 空间自相关基因模块热图
		- 模块分数热图
		- 查看基因的空间特异性
		- 输出空间特异性基因表格

### 数据下载

- \*.h5ad格式：原始数据的AnnData格式，未做处理
- processed.h5ad：处理后的数据
	- 存储原始表达矩阵：`layer['raw_count']`
	- 聚类结果：`obs['clusters']`
	- 细胞类型：`obs['cell_type']`
	- UMAP：`obsm['X_umap']`
	- PCA：`obsm['X_pca']`
	- 空间坐标：`obsm['spatial']`

### 项目筛选

- 检索数据集下更小维度

### 文献筛选

- 时空组文献
- 筛选选项

### 分析工具 - SingleR

- 单细胞在空间的映射情况
- 处理自己的单细胞数据
- 嵌入图和分布情况

### 基因检索

- 基因在不同数据集的表达情况
- 查看是否有空间特异性
- 比较两个数据集间的差异分布

### stereomap

- 查看不同stereo-seq不同bin的分布

### 归档

![[2. 时空数据与数据库.pdf#page=30]]

## 数据常用格式

![[2. 时空数据与数据库.pdf#page=33]]

### scanpy

分析流程：
![[2. 时空数据与数据库.pdf#page=34]]

### Anndata格式

![[2. 时空数据与数据库.pdf#page=36]]

- x：稀疏表达矩阵
	- 行：细胞
	- 列：基因
	- 行列对应表达情况
- .obs: 细胞分类情况，细胞来源的样本
- .var：基因信息，编号，sample ID，统计分析
- .uns：无序注释信息
- .obsm：坐标信息，空间坐标，降维后坐标
- .varm：基因的功能注释

### 常用命令

![[2. 时空数据与数据库.pdf#page=36]]

